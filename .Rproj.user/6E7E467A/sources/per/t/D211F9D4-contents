---
title: "Titanic model"
author: "Augusto Schultz"
date: "06/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Modelo Titanic


```{r cars}
library(tidyverse)



```

```{r}
## Importando os dados

train <- read_csv("titanic/train.csv")
test <- read_csv("titanic/test.csv")

## primeiras visualizações

head(train)
glimpse(train)
summary(train)

```

## Primeiras transformações

```{r}

train <- train %>% 
  mutate(
         Age = if_else(is.na(Age), median(Age, na.rm = TRUE), Age), 
         Embarked = if_else(is.na(Embarked), "S", Embarked)
         )



## Extrair titulos dos nomes

titulo <-  gsub("^.*, (.*?)\\..*$", "\\1", train$Name)


train$titulo <- titulo

## Transformando variaveis em factors
train <- train %>% 
  mutate(Embarked = as.factor(Embarked), Sex = as.factor(Sex), titulo = as.factor(titulo))

## Criando tabela com Dummies
train_dummies <- fastDummies::dummy_columns(.data = train,
                                            select_columns = c("Embarked", "Sex", "titulo"),
                                            remove_selected_columns = TRUE,
                                            remove_most_frequent_dummy = FALSE)

summary(train_dummies)

cor <- train_dummies %>% 
  select(-c(Name,Ticket,Cabin,PassengerId)) %>% 
  cor()

corrplot::corrplot(cor, type = "upper")

modelo_train <- lm(Survived ~ . - Name - Ticket - Cabin - PassengerId, train_dummies)

summary(modelo_train)


```

