"0",""
"0","## Modelo de Regressao linear Multipla"
"0",""
"0","baba_train <- baba_all %>%"
"0","  filter(conj == ""train"") %>%"
"0","  select(-conj, -date, -outdesc, -outmg, -month)"
"0",""
"0","modelo <- lm(formula = venda ~ .,"
"0","                       data = baba_train)"
"0",""
"0","summary(modelo)"
"1","
Call:
"
"1",""
"1","lm(formula = venda ~ ., data = baba_train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","   Min "
"1","    1Q "
"1","Median "
"1","    3Q "
"1","   Max "
"1","
"
"1","-60314 "
"1","-10843 "
"1"," -1809 "
"1","  9185 "
"1","118606 "
"1","
"
"1","
Coefficients: ("
"1",""
"1","1"
"1",""
"1"," not defined because of singularities)
"
"1","                       "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)            "
"1","  2.031e+05"
"1","  1.872e+04"
"1","  10.846"
"1","  < 2e-16"
"1"," ***"
"1","
mesagosto              "
"1"," -5.487e+04"
"1","  8.083e+03"
"1","  -6.788"
"1"," 5.06e-11"
"1"," ***"
"1","
mesdezembro            "
"1"," -3.461e+04"
"1","  7.811e+03"
"1","  -4.431"
"1"," 1.27e-05"
"1"," ***"
"1","
mesfevereiro           "
"1"," -1.026e+04"
"1","  7.485e+03"
"1","  -1.371"
"1"," 0.171218"
"1","    "
"1","
mesjaneiro             "
"1"," -9.923e+03"
"1","  7.452e+03"
"1","  -1.331"
"1"," 0.183917"
"1","    "
"1","
mesjulho               "
"1"," -3.638e+04"
"1","  7.494e+03"
"1","  -4.854"
"1"," 1.84e-06"
"1"," ***"
"1","
mesjunho               "
"1"," -1.741e+04"
"1","  5.129e+03"
"1","  -3.394"
"1"," 0.000769"
"1"," ***"
"1","
mesmaio                "
"1"," -7.343e+02"
"1","  4.667e+03"
"1","  -0.157"
"1"," 0.875065"
"1","    "
"1","
mesmar?o               "
"1"," -3.263e+03"
"1","  5.846e+03"
"1","  -0.558"
"1"," 0.577073"
"1","    "
"1","
mesnovembro            "
"1"," -1.733e+04"
"1","  8.345e+03"
"1","  -2.076"
"1"," 0.038612"
"1"," *  "
"1","
mesoutubro             "
"1"," -2.498e+04"
"1","  8.318e+03"
"1","  -3.003"
"1"," 0.002868"
"1"," ** "
"1","
messetembro            "
"1"," -5.197e+04"
"1","  7.487e+03"
"1","  -6.940"
"1"," 1.98e-11"
"1"," ***"
"1","
weekday2               "
"1"," -5.996e+03"
"1","  3.531e+03"
"1","  -1.698"
"1"," 0.090431"
"1"," .  "
"1","
weekday3               "
"1"," -8.923e+03"
"1","  3.530e+03"
"1","  -2.528"
"1"," 0.011924"
"1"," *  "
"1","
weekday4               "
"1"," -1.468e+04"
"1","  3.544e+03"
"1","  -4.142"
"1"," 4.35e-05"
"1"," ***"
"1","
weekday5               "
"1"," -1.320e+04"
"1","  3.526e+03"
"1","  -3.744"
"1"," 0.000213"
"1"," ***"
"1","
weekday6               "
"1"," -2.475e+04"
"1","  3.652e+03"
"1","  -6.776"
"1"," 5.43e-11"
"1"," ***"
"1","
weekday7               "
"1"," -2.212e+04"
"1","  3.623e+03"
"1","  -6.105"
"1"," 2.80e-09"
"1"," ***"
"1","
margem                 "
"1"," -3.820e+05"
"1","  4.085e+04"
"1","  -9.352"
"1","  < 2e-16"
"1"," ***"
"1","
desconto               "
"1","  8.442e+00"
"1","  2.929e-01"
"1","  28.824"
"1","  < 2e-16"
"1"," ***"
"1","
is_brz_holidayNoholiday"
"1","  8.669e+03"
"1","  6.611e+03"
"1","   1.311"
"1"," 0.190608"
"1","    "
"1","
brz_seasonSpring       "
"1"," -5.163e+02"
"1","  7.031e+03"
"1","  -0.073"
"1"," 0.941507"
"1","    "
"1","
brz_seasonSummer       "
"1"," -4.374e+03"
"1","  5.886e+03"
"1","  -0.743"
"1"," 0.457842"
"1","    "
"1","
brz_seasonWinter       "
"1","  1.792e+04"
"1","  5.925e+03"
"1","   3.024"
"1"," 0.002683"
"1"," ** "
"1","
tx_des                 "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","17960"
"1"," "
"1","on"
"1"," "
"1","341"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.835"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8238"
"1"," "
"1","
F-statistic:"
"1"," "
"1","75.02"
"1"," "
"1","on"
"1"," "
"1","23"
"1"," "
"1","and"
"1"," "
"1","341"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# Retirada de outliers identificados pelo metodo Distancia de Cook"
"0",""
"0","cooksd <- cooks.distance(modelo)"
"0",""
"0","baba_train$cooktest <- cooksd"
"0","baba_train$outlier <- ifelse(2*mean(cooksd) < baba_train$cooktest, 1, 0) #Identificar valores 2 vezes maior que a média da distancia de cook"
"0",""
"0","baba_train <- baba_train %>% "
"0","  filter(outlier != 1) %>% "
"0","  select(-cooktest, -outlier)"
"0",""
"0","## Novo modelo sem outliers"
"0",""
"0","modelo <- lm(formula = venda ~ .,"
"0","                       data = baba_train)"
"0",""
"0","summary(modelo)"
"1","
Call:
"
"1",""
"1","lm(formula = venda ~ ., data = baba_train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","   Min "
"1","    1Q "
"1","Median "
"1","    3Q "
"1","   Max "
"1","
"
"1","-27353 "
"1"," -8684 "
"1"," -1958 "
"1","  6992 "
"1"," 42235 "
"1","
"
"1","
Coefficients: ("
"1",""
"1","1"
"1",""
"1"," not defined because of singularities)
"
"1","                       "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)            "
"1","  1.610e+05"
"1","  1.534e+04"
"1","  10.494"
"1","  < 2e-16"
"1"," ***"
"1","
mesagosto              "
"1"," -3.066e+04"
"1","  6.650e+03"
"1","  -4.610"
"1"," 5.76e-06"
"1"," ***"
"1","
mesdezembro            "
"1"," -3.457e+04"
"1","  6.164e+03"
"1","  -5.609"
"1"," 4.30e-08"
"1"," ***"
"1","
mesfevereiro           "
"1"," -1.120e+04"
"1","  5.807e+03"
"1","  -1.928"
"1"," 0.054706"
"1"," .  "
"1","
mesjaneiro             "
"1"," -7.538e+03"
"1","  5.815e+03"
"1","  -1.296"
"1"," 0.195792"
"1","    "
"1","
mesjulho               "
"1"," -3.257e+04"
"1","  5.847e+03"
"1","  -5.569"
"1"," 5.30e-08"
"1"," ***"
"1","
mesjunho               "
"1"," -1.484e+04"
"1","  3.967e+03"
"1","  -3.742"
"1"," 0.000215"
"1"," ***"
"1","
mesmaio                "
"1"," -2.168e+03"
"1","  3.625e+03"
"1","  -0.598"
"1"," 0.550321"
"1","    "
"1","
mesmar?o               "
"1"," -1.579e+03"
"1","  4.539e+03"
"1","  -0.348"
"1"," 0.728216"
"1","    "
"1","
mesnovembro            "
"1"," -2.334e+04"
"1","  6.630e+03"
"1","  -3.521"
"1"," 0.000490"
"1"," ***"
"1","
mesoutubro             "
"1"," -2.625e+04"
"1","  6.647e+03"
"1","  -3.950"
"1"," 9.56e-05"
"1"," ***"
"1","
messetembro            "
"1"," -3.285e+04"
"1","  5.958e+03"
"1","  -5.514"
"1"," 7.07e-08"
"1"," ***"
"1","
weekday2               "
"1"," -7.978e+03"
"1","  2.748e+03"
"1","  -2.903"
"1"," 0.003950"
"1"," ** "
"1","
weekday3               "
"1"," -1.111e+04"
"1","  2.794e+03"
"1","  -3.976"
"1"," 8.59e-05"
"1"," ***"
"1","
weekday4               "
"1"," -1.586e+04"
"1","  2.772e+03"
"1","  -5.722"
"1"," 2.36e-08"
"1"," ***"
"1","
weekday5               "
"1"," -1.907e+04"
"1","  2.782e+03"
"1","  -6.855"
"1"," 3.50e-11"
"1"," ***"
"1","
weekday6               "
"1"," -3.073e+04"
"1","  2.890e+03"
"1"," -10.634"
"1","  < 2e-16"
"1"," ***"
"1","
weekday7               "
"1"," -2.735e+04"
"1","  2.849e+03"
"1","  -9.603"
"1","  < 2e-16"
"1"," ***"
"1","
margem                 "
"1"," -2.789e+05"
"1","  3.419e+04"
"1","  -8.158"
"1"," 7.18e-15"
"1"," ***"
"1","
desconto               "
"1","  6.749e+00"
"1","  3.240e-01"
"1","  20.828"
"1","  < 2e-16"
"1"," ***"
"1","
is_brz_holidayNoholiday"
"1","  1.496e+04"
"1","  5.407e+03"
"1","   2.767"
"1"," 0.005984"
"1"," ** "
"1","
brz_seasonSpring       "
"1","  1.296e+04"
"1","  5.589e+03"
"1","   2.319"
"1"," 0.021016"
"1"," *  "
"1","
brz_seasonSummer       "
"1","  4.512e+03"
"1","  4.588e+03"
"1","   0.984"
"1"," 0.326068"
"1","    "
"1","
brz_seasonWinter       "
"1","  1.177e+04"
"1","  4.605e+03"
"1","   2.557"
"1"," 0.011016"
"1"," *  "
"1","
tx_des                 "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","13740"
"1"," "
"1","on"
"1"," "
"1","331"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8417"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8307"
"1"," "
"1","
F-statistic:"
"1"," "
"1","76.51"
"1"," "
"1","on"
"1"," "
"1","23"
"1"," "
"1","and"
"1"," "
"1","331"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
