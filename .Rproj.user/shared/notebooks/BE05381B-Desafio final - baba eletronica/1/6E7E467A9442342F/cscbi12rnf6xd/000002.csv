"0","# Treino #"
"0","baba_train <- read.csv(""https://raw.githubusercontent.com/diogenesjusto/FIAP/master/SHIFT/202007/Desafio/train_BABA.csv"")"
"0",""
"0","baba_train$conj <- ""train"""
"0",""
"0","# Teste #"
"0",""
"0","baba_test <- read.csv(""https://raw.githubusercontent.com/diogenesjusto/FIAP/master/SHIFT/202007/Desafio/test_BABA.csv"")"
"0",""
"0","baba_test$venda <- NA"
"0","baba_test$conj <- ""test"""
"0",""
"0","# Uniao das bases"
"0",""
"0","baba_all <- rbind(baba_train, baba_test)"
"0",""
"0","baba_all <- baba_all %>% "
"0","  select(-X) %>%"
"0","  mutate("
"0","        date = ymd(date),"
"0","        month = floor_date(date, ""month""),"
"0","        weekday = case_when( "
"0","                              weekday == ""segunda-feira"" ~ 1,"
"0","                              weekday == ""ter?a-feira""~ 2,"
"0","                              weekday == ""quarta-feira"" ~  3,"
"0","                              weekday == ""quinta-feira"" ~  4,"
"0","                              weekday == ""sexta-feira"" ~  5,"
"0","                              weekday == ""s?bado"" ~  6,"
"0","                              weekday == ""domingo"" ~ 7"
"0","                              )"
"0","        )"
"0",""
"0","# Base de datas"
"0",""
"0","dim_date <- read_excel(""dim_date2.xlsx"")"
"0","dim_date$date_id <- as.Date(as.integer(dim_date$date_id), origin = ""1899-12-30"")"
"0",""
"0","## join com base de datas"
"0",""
"0","baba_all <- left_join(baba_all, dim_date, by = c(""date"" = ""date_id""))"
"0",""
"0","# TransformaÃ§Ã£o para variaveis nominais"
"0",""
"0","baba_all <- baba_all %>% "
"0","  mutate(weekday = as.character(weekday), mes = as.character(mes), is_brz_holiday = as.character(is_brz_holiday), brz_season = as.character(brz_season))"
"0",""
"0",""
